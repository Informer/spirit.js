/*! Spirit - v0.1.0 - 2014-03-25
* http://spiritjs.io/
* Copyright (c) 2014 Patrick Brouwer; 
*/
(function(t){"use strict";var e={},n=function(t){for(var n=t.split("."),r=0,i=n.length,o=e;i>r;++r){var u=n[r];o[u]||(o[u]={}),o=o[u]}return o},r=function(t){if("string"!=typeof t)return!1;for(var n=t.split("."),r=!0,i=0,o=n.length,u=e;o>i;++i){var s=n[i];if(!u[s]){r=!1;break}u=u[s]}return r};(function(e){(function(){function n(t,e,n){for(var r=(n||0)-1,i=t?t.length:0;i>++r;)if(t[r]===e)return r;return-1}function r(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||n===en)return 1;if(r>n||r===en)return-1}return t.index-e.index}function i(t){return"\\"+_n[t]}function o(){}function u(t){return t instanceof u?t:new s(t)}function s(t,e){this.__chain__=!!e,this.__wrapped__=t}function a(t,e,n){if("function"!=typeof t)return Pe;if(e===en)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return Se(t,e)}function l(t,e,n,r){for(var i=(r||0)-1,o=t?t.length:0,u=[];o>++i;){var s=t[i];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Gn(s)||y(s))){e||(s=l(s,e,n));var a=-1,c=s.length,f=u.length;for(u.length+=c;c>++a;)u[f++]=s[a]}else n||u.push(s)}return u}function c(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;var i=typeof t,o=typeof e;if(!(t!==t||t&&yn[i]||e&&yn[o]))return!1;if(null==t||null==e)return t===e;var s=zn.call(t),a=zn.call(e);if(s!=a)return!1;switch(s){case fn:case hn:return+t==+e;case dn:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case gn:case mn:return t==e+""}var l=s==cn;if(!l){if(Nn.call(t,"__wrapped__ ")||e instanceof u)return c(t.__wrapped__||t,e.__wrapped__||e,n,r);if(s!=vn)return!1;var f=t.constructor,h=e.constructor;if(f!=h&&!(N(f)&&f instanceof f&&N(h)&&h instanceof h))return!1}n||(n=[]),r||(r=[]);for(var p=n.length;p--;)if(n[p]==t)return r[p]==e;var d=!0,v=0;if(n.push(t),r.push(e),l){if(v=e.length,d=v==t.length)for(;v--&&(d=c(t[v],e[v],n,r)););return d}return nr(e,function(e,i,o){return Nn.call(o,i)?(v++,!(d=Nn.call(t,i)&&c(t[i],e,n,r))&&rn):en}),d&&nr(t,function(t,e,n){return Nn.call(n,e)?!(d=--v>-1)&&rn:en}),d}function f(t,e,n){for(var r=-1,i=g(),o=t?t.length:0,u=[],s=n?[]:u;o>++r;){var a=t[r],l=n?n(a,r,t):a;(e?!r||s[s.length-1]!==l:0>i(s,l))&&(n&&s.push(l),u.push(a))}return u}function h(t){return function(e,n,r){var i={};n=Ce(n,r,3);var o=-1,u=e?e.length:0;if("number"==typeof u)for(;u>++o;){var s=e[o];t(i,s,n(s,o,e),e)}else rr(e,function(e,r,o){t(i,e,n(e,r,o),o)});return i}}function p(t,e,n,r,i,o){var u=1&e,s=2&e,a=4&e,l=8&e,c=16&e,f=32&e,h=t;if(!s&&!N(t))throw new TypeError;if(c&&!n.length&&(e&=-17,c=n=!1),f&&!r.length&&(e&=-33,f=r=!1),!u||s||a||f||!(Hn.fastBind||Rn&&c))g=function(){var v=arguments,m=u?i:this;if((a||c||f)&&(v=Qn.call(v),c&&Bn.apply(v,n),f&&In.apply(v,r),a&&o>v.length))return e|=16,p(t,l?e:-4&e,v,null,i,o);if(s&&(t=m[h]),this instanceof g){m=d(t.prototype);var y=t.apply(m,v);return C(y)?y:m}return t.apply(m,v)};else{if(c){var v=[i];In.apply(v,n)}var g=c?Rn.apply(t,v):Rn.call(t,i)}return g}function d(t){return C(t)?$n(t):{}}function v(t){return Yn[t]}function g(){var t=(t=u.indexOf)===ve?n:t;return t}function m(t){return Zn[t]}function y(t){return t&&"object"==typeof t&&"number"==typeof t.length&&zn.call(t)==ln||!1}function _(t){if(!t)return t;for(var e=1,n=arguments.length;n>e;e++){var r=arguments[e];if(r)for(var i in r)t[i]=r[i]}return t}function b(t){return C(t)?Gn(t)?Qn.call(t):_({},t):t}function w(t){if(!t)return t;for(var e=1,n=arguments.length;n>e;e++){var r=arguments[e];if(r)for(var i in r)t[i]===en&&(t[i]=r[i])}return t}function x(t){var e=[];return nr(t,function(t,n){N(t)&&e.push(n)}),e.sort()}function A(t,e){return t?Nn.call(t,e):!1}function j(t){for(var e=-1,n=Xn(t),r=n.length,i={};r>++e;){var o=n[e];i[t[o]]=o}return i}function E(t){return t===!0||t===!1||zn.call(t)==fn}function T(t){return t?"object"==typeof t&&zn.call(t)==hn:!1}function M(t){return t?1===t.nodeType:!1}function O(t){if(!t)return!0;if(Gn(t)||$(t))return!t.length;for(var e in t)if(Nn.call(t,e))return!1;return!0}function S(t,e){return c(t,e)}function k(t){return Fn(t)&&!Wn(parseFloat(t))}function N(t){return"function"==typeof t}function C(t){return!(!t||!yn[typeof t])}function I(t){return B(t)&&t!=+t}function z(t){return null===t}function B(t){return"number"==typeof t||zn.call(t)==dn}function R(t){return t&&yn[typeof t]?zn.call(t)==gn:!1}function $(t){return"string"==typeof t||zn.call(t)==mn}function q(t){return t===en}function F(t){var e=g(),n=l(arguments,!0,!1,1),r={};return nr(t,function(t,i){0>e(n,i)&&(r[i]=t)}),r}function W(t){for(var e=-1,n=Xn(t),r=n.length,i=Array(r);r>++e;){var o=n[e];i[e]=[o,t[o]]}return i}function D(t){for(var e=-1,n=l(arguments,!0,!1,1),r=n.length,i={};r>++e;){var o=n[e];o in t&&(i[o]=t[o])}return i}function P(t){for(var e=-1,n=Xn(t),r=n.length,i=Array(r);r>++e;)i[e]=t[n[e]];return i}function J(t,e){var n=g(),r=t?t.length:0,i=!1;return r&&"number"==typeof r?i=n(t,e)>-1:rr(t,function(t){return(i=t===e)&&rn}),i}function L(t,e,n){var r=!0;e=Ce(e,n,3);var i=-1,o=t?t.length:0;if("number"==typeof o)for(;o>++i&&(r=!!e(t[i],i,t)););else rr(t,function(t,n,i){return!(r=!!e(t,n,i))&&rn});return r}function Q(t,e,n){var r=[];e=Ce(e,n,3);var i=-1,o=t?t.length:0;if("number"==typeof o)for(;o>++i;){var u=t[i];e(u,i,t)&&r.push(u)}else rr(t,function(t,n,i){e(t,n,i)&&r.push(t)});return r}function U(t,e,n){e=Ce(e,n,3);var r=-1,i=t?t.length:0;if("number"!=typeof i){var o;return rr(t,function(t,n,r){return e(t,n,r)?(o=t,rn):en}),o}for(;i>++r;){var u=t[r];if(e(u,r,t))return u}}function V(t,e){return ce(t,e,!0)}function H(t,e,n){var r=-1,i=t?t.length:0;if(e=e&&n===en?e:a(e,n,3),"number"==typeof i)for(;i>++r&&e(t[r],r,t)!==rn;);else rr(t,e)}function G(t,e){var n=t?t.length:0;if("number"==typeof n)for(;n--&&e(t[n],n,t)!==!1;);else{var r=Xn(t);n=r.length,rr(t,function(t,i,o){return i=r?r[--n]:--n,e(o[i],i,o)===!1&&rn})}}function K(t,e){var n=Qn.call(arguments,2),r=-1,i="function"==typeof e,o=t?t.length:0,u=Array("number"==typeof o?o:0);return H(t,function(t){u[++r]=(i?e:t[e]).apply(t,n)}),u}function X(t,e,n){var r=-1,i=t?t.length:0;if(e=Ce(e,n,3),"number"==typeof i)for(var o=Array(i);i>++r;)o[r]=e(t[r],r,t);else o=[],rr(t,function(t,n,i){o[++r]=e(t,n,i)});return o}function Y(t,e,n){var r=-1/0,i=r,o=-1,u=t?t.length:0;if(e||"number"!=typeof u)e=Ce(e,n,3),H(t,function(t,n,o){var u=e(t,n,o);u>r&&(r=u,i=t)});else for(;u>++o;){var s=t[o];s>i&&(i=s)}return i}function Z(t,e,n){var r=1/0,i=r,o=-1,u=t?t.length:0;if(e||"number"!=typeof u)e=Ce(e,n,3),H(t,function(t,n,o){var u=e(t,n,o);r>u&&(r=u,i=t)});else for(;u>++o;){var s=t[o];i>s&&(i=s)}return i}function te(t,e){var n=-1,r=t?t.length:0;if("number"==typeof r)for(var i=Array(r);r>++n;)i[n]=t[n][e];return i||X(t,e)}function ee(t,e,n,r){if(!t)return n;var i=3>arguments.length;e=a(e,r,4);var o=-1,u=t.length;if("number"==typeof u)for(i&&(n=t[++o]);u>++o;)n=e(n,t[o],o,t);else rr(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)});return n}function ne(t,e,n,r){var i=3>arguments.length;return e=a(e,r,4),G(t,function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)}),n}function re(t,e,n){return e=Ce(e,n,3),Q(t,function(t,n,r){return!e(t,n,r)})}function ie(t,e,n){var r=t?t.length:0;if("number"!=typeof r&&(t=P(t)),null==e||n)return t?t[Qe(r-1)]:en;var i=oe(t);return i.length=Jn(Pn(0,e),i.length),i}function oe(t){var e=-1,n=t?t.length:0,r=Array("number"==typeof n?n:0);return H(t,function(t){var n=Qe(++e);r[e]=r[n],r[n]=t}),r}function ue(t){var e=t?t.length:0;return"number"==typeof e?e:Xn(t).length}function se(t,e,n){var r;e=Ce(e,n,3);var i=-1,o=t?t.length:0;if("number"==typeof o)for(;o>++i&&!(r=e(t[i],i,t)););else rr(t,function(t,n,i){return(r=e(t,n,i))&&rn});return!!r}function ae(t,e,n){var i=-1,o=t?t.length:0,u=Array("number"==typeof o?o:0);for(e=Ce(e,n,3),H(t,function(t,n,r){u[++i]={criteria:e(t,n,r),index:i,value:t}}),o=u.length,u.sort(r);o--;)u[o]=u[o].value;return u}function le(t){return Gn(t)?Qn.call(t):t&&"number"==typeof t.length?X(t):P(t)}function ce(t,e,n){return n&&O(e)?en:(n?U:Q)(t,e)}function fe(t){for(var e=-1,n=t?t.length:0,r=[];n>++e;){var i=t[e];i&&r.push(i)}return r}function he(t){for(var e=-1,n=g(),r=t.length,i=l(arguments,!0,!0,1),o=[];r>++e;){var u=t[e];0>n(i,u)&&o.push(u)}return o}function pe(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=-1;for(e=Ce(e,n,3);i>++o&&e(t[o],o,t);)r++}else if(r=e,null==r||n)return t?t[0]:en;return Qn.call(t,0,Jn(Pn(0,r),i))}function de(t,e){return l(t,e)}function ve(t,e,r){if("number"==typeof r){var i=t?t.length:0;r=0>r?Pn(0,i+r):r||0}else if(r){var o=xe(t,e);return t[o]===e?o:-1}return n(t,e,r)}function ge(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=i;for(e=Ce(e,n,3);o--&&e(t[o],o,t);)r++}else r=null==e||n?1:e||r;return Qn.call(t,0,Jn(Pn(0,i-r),i))}function me(t){var e=arguments,n=e.length,r=-1,i=g(),o=t?t.length:0,u=[];t:for(;o>++r;){var s=t[r];if(0>i(u,s)){for(var a=n;--a;)if(0>i(e[a],s))continue t;u.push(s)}}return u}function ye(t,e,n){var r=0,i=t?t.length:0;if("number"!=typeof e&&null!=e){var o=i;for(e=Ce(e,n,3);o--&&e(t[o],o,t);)r++}else if(r=e,null==r||n)return t?t[i-1]:en;return Qn.call(t,Pn(0,i-r))}function _e(t,e,n){var r=t?t.length:0;for("number"==typeof n&&(r=(0>n?Pn(0,r+n):Jn(n,r-1))+1);r--;)if(t[r]===e)return r;return-1}function be(t,e,n){t=+t||0,n=+n||1,null==e&&(e=t,t=0);for(var r=-1,i=Pn(0,Sn((e-t)/n)),o=Array(i);i>++r;)o[r]=t,t+=n;return o}function we(t,e,n){if("number"!=typeof e&&null!=e){var r=0,i=-1,o=t?t.length:0;for(e=Ce(e,n,3);o>++i&&e(t[i],i,t);)r++}else r=null==e||n?1:Pn(0,e);return Qn.call(t,r)}function xe(t,e,n,r){var i=0,o=t?t.length:i;for(n=n?Ce(n,r,1):Pe,e=n(e);o>i;){var u=i+o>>>1;e>n(t[u])?i=u+1:o=u}return i}function Ae(){return f(l(arguments,!0,!0))}function je(t,e,n,r){return"boolean"!=typeof e&&null!=e&&(r=n,n=r&&r[e]===t?null:e,e=!1),null!=n&&(n=Ce(n,r,3)),f(t,e,n)}function Ee(t){return he(t,Qn.call(arguments,1))}function Te(){for(var t=-1,e=Y(te(arguments,"length")),n=Array(0>e?0:e);e>++t;)n[t]=te(arguments,t);return n}function Me(t,e){for(var n=-1,r=t?t.length:0,i={};r>++n;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}function Oe(t,e){if(!N(e))throw new TypeError;return function(){return 1>--t?e.apply(this,arguments):en}}function Se(t,e){return arguments.length>2?p(t,17,Qn.call(arguments,2),null,e):p(t,1,null,null,e)}function ke(t){for(var e=arguments.length>1?l(arguments,!0,!1,1):x(t),n=-1,r=e.length;r>++n;){var i=e[n];t[i]=p(t[i],1,null,null,t)}return t}function Ne(){for(var t=arguments,e=t.length;e--;)if(!N(t[e]))throw new TypeError;return function(){for(var e=arguments,n=t.length;n--;)e=[t[n].apply(this,e)];return e[0]}}function Ce(t,e,n){var r=typeof t;if(null==t||"function"==r)return a(t,e,n);if("object"!=r)return function(e){return e[t]};var i=Xn(t);return function(e){for(var n=i.length,r=!1;n--&&(r=e[i[n]]===t[i[n]]););return r}}function Ie(t,e,n){var r,i,o,u,s,a,l,c=0,f=!1,h=!0;if(!N(t))throw new TypeError;if(e=Pn(0,e)||0,n===!0){var p=!0;h=!1}else C(n)&&(p=n.leading,f="maxWait"in n&&(Pn(e,n.maxWait)||0),h="trailing"in n?n.trailing:h);var d=function(){var n=e-(Cn()-u);if(0>=n){i&&clearTimeout(i);var f=l;i=a=l=en,f&&(c=Cn(),o=t.apply(s,r))}else a=setTimeout(d,n)},v=function(){a&&clearTimeout(a),i=a=l=en,(h||f!==e)&&(c=Cn(),o=t.apply(s,r))};return function(){if(r=arguments,u=Cn(),s=this,l=h&&(a||!p),f===!1)var n=p&&!a;else{i||p||(c=u);var g=f-(u-c);0>=g?(i&&(i=clearTimeout(i)),c=u,o=t.apply(s,r)):i||(i=setTimeout(v,g))}return a||e===f||(a=setTimeout(d,e)),n&&(o=t.apply(s,r)),o}}function ze(t){if(!N(t))throw new TypeError;var e=Qn.call(arguments,1);return setTimeout(function(){t.apply(en,e)},1)}function Be(t,e){if(!N(t))throw new TypeError;var n=Qn.call(arguments,2);return setTimeout(function(){t.apply(en,n)},e)}function Re(t,e){var n={};return function(){var r=e?e.apply(this,arguments):on+arguments[0];return Nn.call(n,r)?n[r]:n[r]=t.apply(this,arguments)}}function $e(t){var e,n;if(!N(t))throw new TypeError;return function(){return e?n:(e=!0,n=t.apply(this,arguments),t=null,n)}}function qe(t){return p(t,16,Qn.call(arguments,1))}function Fe(t,e,n){var r=!0,i=!0;if(!N(t))throw new TypeError;return n===!1?r=!1:C(n)&&(r="leading"in n?n.leading:r,i="trailing"in n?n.trailing:i),n={},n.leading=r,n.maxWait=e,n.trailing=i,Ie(t,e,n)}function We(t,e){if(!N(e))throw new TypeError;return function(){var n=[t];return In.apply(n,arguments),e.apply(this,n)}}function De(t){return null==t?"":(t+"").replace(er,v)}function Pe(t){return t}function Je(t){H(x(t),function(e){var n=u[e]=t[e];u.prototype[e]=function(){var t=[this.__wrapped__];In.apply(t,arguments);var e=n.apply(u,t);return this.__chain__?new s(e,!0):e}})}function Le(){return bn._=Mn,this}function Qe(t,e){return null==t&&null==e&&(e=1),t=+t||0,null==e?(e=t,t=0):e=+e||0,t+kn(Ln()*(e-t+1))}function Ue(t,e){if(t){var n=t[e];return N(n)?t[e]():n}}function Ve(t,e,n){var r=u,o=r.templateSettings;t||(t=""),n=w({},n,o);var s=0,a="__p += '",l=n.variable,c=RegExp((n.escape||sn).source+"|"+(n.interpolate||sn).source+"|"+(n.evaluate||sn).source+"|$","g");t.replace(c,function(e,n,r,o,u){return a+=t.slice(s,u).replace(an,i),n&&(a+="' +\n_.escape("+n+") +\n'"),o&&(a+="';\n"+o+";\n__p += '"),r&&(a+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),s=u+e.length,e}),a+="';\n",l||(l="obj",a="with ("+l+" || {}) {\n"+a+"\n}\n"),a="function("+l+") {\n"+"var __t, __p = '', __j = Array.prototype.join;\n"+"function print() { __p += __j.call(arguments, '') }\n"+a+"return __p\n}";try{var f=Function("_","return "+a)(r)}catch(h){throw h.source=a,h}return e?f(e):(f.source=a,f)}function He(t,e,n){t=(t=+t)>-1?t:0;var r=-1,i=Array(t);for(e=a(e,n,1);t>++r;)i[r]=e(r);return i}function Ge(t){return null==t?"":(t+"").replace(tr,m)}function Ke(t){var e=++nn+"";return t?t+e:e}function Xe(t){return t=new s(t),t.__chain__=!0,t}function Ye(t,e){return e(t),t}function Ze(){return this.__chain__=!0,this}function tn(){return this.__wrapped__}var en,nn=0,rn={},on=+new Date+"",un=/<%=([\s\S]+?)%>/g,sn=/($^)/,an=/['\n\r\t\u2028\u2029\\]/g,ln="[object Arguments]",cn="[object Array]",fn="[object Boolean]",hn="[object Date]",pn="[object Function]",dn="[object Number]",vn="[object Object]",gn="[object RegExp]",mn="[object String]",yn={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},_n={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},bn=yn[typeof window]&&window||this,wn=yn[typeof exports]&&exports&&!exports.nodeType&&exports,xn=yn[typeof module]&&module&&!module.nodeType&&module,An=xn&&xn.exports===wn&&wn,jn=yn[typeof t]&&t;!jn||jn.global!==jn&&jn.window!==jn||(bn=jn);var En=[],Tn=Object.prototype,Mn=bn._,On=RegExp("^"+(Tn.valueOf+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Sn=Math.ceil,kn=Math.floor,Nn=Tn.hasOwnProperty,Cn=On.test(Cn=Date.now)&&Cn||function(){return+new Date},In=En.push,zn=Tn.toString,Bn=En.unshift,Rn=On.test(Rn=zn.bind)&&Rn,$n=On.test($n=Object.create)&&$n,qn=On.test(qn=Array.isArray)&&qn,Fn=bn.isFinite,Wn=bn.isNaN,Dn=On.test(Dn=Object.keys)&&Dn,Pn=Math.max,Jn=Math.min,Ln=Math.random,Qn=En.slice,Un=On.test(bn.attachEvent),Vn=Rn&&!/\n|true/.test(Rn+Un);s.prototype=u.prototype;var Hn={};(function(){var t={0:1,length:1};Hn.fastBind=Rn&&!Vn,Hn.spliceObjects=(En.splice.call(t,0,1),!t[0])})(1),u.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:un,variable:""},$n||(d=function(t){if(C(t)){o.prototype=t;var e=new o;o.prototype=null}return e||{}}),y(arguments)||(y=function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Nn.call(t,"callee")||!1});var Gn=qn||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&zn.call(t)==cn||!1},Kn=function(t){var e,n=t,r=[];if(!n)return r;if(!yn[typeof t])return r;for(e in n)Nn.call(n,e)&&r.push(e);return r},Xn=Dn?function(t){return C(t)?Dn(t):[]}:Kn,Yn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Zn=j(Yn),tr=RegExp("("+Xn(Zn).join("|")+")","g"),er=RegExp("["+Xn(Yn).join("")+"]","g"),nr=function(t,e){var n,r=t,i=r;if(!r)return i;if(!yn[typeof r])return i;for(n in r)if(e(r[n],n,t)===rn)return i;return i},rr=function(t,e){var n,r=t,i=r;if(!r)return i;if(!yn[typeof r])return i;for(n in r)if(Nn.call(r,n)&&e(r[n],n,t)===rn)return i;return i};N(/x/)&&(N=function(t){return"function"==typeof t&&zn.call(t)==pn});var ir=h(function(t,e,n){Nn.call(t,n)?t[n]++:t[n]=1}),or=h(function(t,e,n){(Nn.call(t,n)?t[n]:t[n]=[]).push(e)}),ur=h(function(t,e,n){t[n]=e});u.after=Oe,u.bind=Se,u.bindAll=ke,u.chain=Xe,u.compact=fe,u.compose=Ne,u.countBy=ir,u.debounce=Ie,u.defaults=w,u.defer=ze,u.delay=Be,u.difference=he,u.filter=Q,u.flatten=de,u.forEach=H,u.functions=x,u.groupBy=or,u.indexBy=ur,u.initial=ge,u.intersection=me,u.invert=j,u.invoke=K,u.keys=Xn,u.map=X,u.max=Y,u.memoize=Re,u.min=Z,u.omit=F,u.once=$e,u.pairs=W,u.partial=qe,u.pick=D,u.pluck=te,u.range=be,u.reject=re,u.rest=we,u.shuffle=oe,u.sortBy=ae,u.tap=Ye,u.throttle=Fe,u.times=He,u.toArray=le,u.union=Ae,u.uniq=je,u.values=P,u.where=ce,u.without=Ee,u.wrap=We,u.zip=Te,u.collect=X,u.drop=we,u.each=H,u.extend=_,u.methods=x,u.object=Me,u.select=Q,u.tail=we,u.unique=je,u.clone=b,u.contains=J,u.escape=De,u.every=L,u.find=U,u.has=A,u.identity=Pe,u.indexOf=ve,u.isArguments=y,u.isArray=Gn,u.isBoolean=E,u.isDate=T,u.isElement=M,u.isEmpty=O,u.isEqual=S,u.isFinite=k,u.isFunction=N,u.isNaN=I,u.isNull=z,u.isNumber=B,u.isObject=C,u.isRegExp=R,u.isString=$,u.isUndefined=q,u.lastIndexOf=_e,u.mixin=Je,u.noConflict=Le,u.random=Qe,u.reduce=ee,u.reduceRight=ne,u.result=Ue,u.size=ue,u.some=se,u.sortedIndex=xe,u.template=Ve,u.unescape=Ge,u.uniqueId=Ke,u.all=L,u.any=se,u.detect=U,u.findWhere=V,u.foldl=ee,u.foldr=ne,u.include=J,u.inject=ee,u.first=pe,u.last=ye,u.sample=ie,u.take=pe,u.head=pe,Je(u),u.VERSION="2.2.1",u.prototype.chain=Ze,u.prototype.value=tn,H(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=En[t];u.prototype[t]=function(){var t=this.__wrapped__;return e.apply(t,arguments),Hn.spliceObjects||0!==t.length||delete t[0],this}}),H(["concat","join","slice"],function(t){var e=En[t];u.prototype[t]=function(){var t=this.__wrapped__,n=e.apply(t,arguments);return this.__chain__&&(n=new s(n),n.__chain__=!0),n}}),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(bn._=u,define(function(){return u})):wn&&xn?An?(xn.exports=u)._=u:wn._=u:u.extend(e,u)}).call(e)})(n("spirit._helpers")),function(t){var e=function(){};t.extendObject=function(e,n){var r,i=this;r=e&&t.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},t.extend(r,i,n);var o=function(){this.constructor=r};return o.prototype=i.prototype,r.prototype=new o,e&&t.extend(r.prototype,e),r.__super__=i.prototype,r};var n=function(n,r,i){var o,u=n.prototype,s=/xyz/.test(function(t){})?/\b_super\b/:/.*/;if(o=r&&r.hasOwnProperty("constructor")?r.constructor:function(){n.apply(this,arguments)},t.extend(o,n),e.prototype=n.prototype,o.prototype=new e,r){t.extend(o.prototype,r);for(var a in r)"function"==typeof r[a]&&"function"==typeof u[a]&&s.test(r[a])&&(o.prototype[a]=function(t,e){return function(){var n=this._super;this._super=u[t];var r=e.apply(this,arguments);return this._super=n,r}}(a,r[a]))}return i&&t.extend(o,i),o.prototype.constructor=o,o.__super__=n.prototype,o};t.extendObjectWithSuper=function(e,r){var i=n(this,e,r);return i.extend=t.extendObject,i},t.autoBind=function(e){var n=t.functions(e.constructor.prototype);t.each(n,function(n){"_"!==n.charAt(0)&&-1===t.indexOf(["autoBind","constructor"],n)&&(e[n]=t.bind(e[n],e))})},t.testMode=function(){return!!window.__karma__}}(n("spirit._helpers"));var i=n("spirit._helpers");(function(t){var e=n("spirit._helpers"),r=/\s+/,i=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)t[e].apply(t,[o,n[o]].concat(i));return!1}if(r.test(n)){for(var u=n.split(r),s=0,a=u.length;a>s;s++)t[e].apply(t,[u[s]].concat(i));return!1}return!0},o=function(t,e){var n,r=-1,i=t.length,o=e[0],u=e[1],s=e[2];switch(e.length){case 0:for(;i>++r;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;i>++r;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;i>++r;)(n=t[r]).callback.call(n.ctx,o,u);return;case 3:for(;i>++r;)(n=t[r]).callback.call(n.ctx,o,u,s);return;default:for(;i>++r;)(n=t[r]).callback.apply(n.ctx,e)}};t.Events={on:function(t,e,n){if(!i(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,n,r){if(!i(this,"once",t,[n,r])||!n)return this;var o=this,u=e.once(function(){o.off(t,u),n.apply(this,arguments)});return u._callback=n,this.on(t,u,r)},off:function(t,n,r){var o,u,s,a,l,c,f,h;if(!this._events||!i(this,"off",t,[n,r]))return this;if(!t&&!n&&!r)return this._events={},this;for(a=t?[t]:e.keys(this._events),l=0,c=a.length;c>l;l++)if(t=a[l],s=this._events[t]){if(this._events[t]=o=[],n||r)for(f=0,h=s.length;h>f;f++)u=s[f],(n&&n!==u.callback&&n!==u.callback._callback||r&&r!==u.context)&&o.push(u);o.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=[].slice.call(arguments,1);if(!i(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&o(n,e),r&&o(r,arguments),this},stopListening:function(t,n,r){var i=this._listeningTo;if(!i)return this;var o=!n&&!r;r||"object"!=typeof n||(r=this),t&&((i={})[t._listenId]=t);for(var u in i)t=i[u],t.off(n,r,this),(o||e.isEmpty(t._events))&&delete this._listeningTo[u];return this}}})(n("spirit.event")),function(t){var e=n("spirit._helpers"),i=function(t,e){var n=e.error;e.error=function(r){n&&n(t,r,e),t.trigger("error",t,r,e)}},o=function(t){var i=t;try{if(e.isString(i)&&r(i)&&(i=n(i)),i.parseable===!0)return i;if(i.constructor.parseable===!0)return i.constructor}catch(o){}return!1};t.AbstractModel=function(t,n){this._parseables={},e.each(this.defaults,function(t,e){var n=o(t);n&&(this._parseables[e]=n)},this);var r=t||{};n||(n={}),this.cid=e.uniqueId("c"),this.attributes={},n.collection&&(this.collection=n.collection),n.parse&&(r=this.parse(r,n)||{}),r=e.defaults({},r,e.result(this,"defaults")),this.set(r,n),this.changed={},this.initialize.apply(this,arguments)},t.AbstractModel.extend=e.extendObjectWithSuper,e.extend(t.AbstractModel.prototype,n("spirit.event").Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return e.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){return e.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(n,r,i){var o,u,s,a,l,c,f,h;if(null==n)return this;if("object"==typeof n?(u=n,i=r):(u={})[n]=r,i||(i={}),!this._validate(u,i))return!1;s=i.unset,l=i.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=e.clone(this.attributes),this.changed={}),h=this.attributes,f=this._previousAttributes,this.idAttribute in u&&(this.id=u[this.idAttribute]);for(o in u)if(r=u[o],e.isEqual(h[o],r)||a.push(o),e.isEqual(f[o],r)?delete this.changed[o]:this.changed[o]=r,s)delete h[o];else{var p=this._parseables[o];h[o]=p?e.isArray(r)||e.isObject(r)&&r instanceof t.AbstractModel?new p(r):new p:r}if(!l){a.length&&(this._pending=!0);for(var d=0,v=a.length;v>d;d++)this.trigger("change:"+a[d],this,h[a[d]],i)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,n){return this.set(t,void 0,e.extend({},n,{unset:!0}))},clear:function(t){var n={};for(var r in this.attributes)n[r]=void 0;return this.set(n,e.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!e.isEmpty(this.changed):e.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?e.clone(this.changed):!1;var n,r=!1,i=this._changing?this._previousAttributes:this.attributes;for(var o in t)e.isEqual(i[o],n=t[o])||((r||(r={}))[o]=n);return r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return e.clone(this._previousAttributes)},fetch:function(t){t=t?e.clone(t):{},void 0===t.parse&&(t.parse=!0);var n=this,r=t.success;return t.success=function(e){return n.set(n.parse(e,t),t)?(r&&r(n,e,t),n.trigger("sync",n,e,t),void 0):!1},i(this,t),this.sync("read",this,t)},destroy:function(t){t=t?e.clone(t):{};var n=this,r=t.success,o=function(){n.trigger("destroy",n,n.collection,t)};return t.success=function(e){(t.wait||n.isNew())&&o(),r&&r(n,e,t),n.isNew()||n.trigger("sync",n,e,t)},this.isNew()?(t.success(),!1):(i(this,t),t.wait||o(),!0)},url:function(){var t=e.result(this,"urlRoot")||e.result(this.collection,"url")||urlError();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},e.extend(t||{},{validate:!0}))},_validate:function(t,n){if(!n.validate||!this.validate)return!0;t=e.extend({},this.attributes,t);var r=this.validationError=this.validate(t,n)||null;return r?(this.trigger("invalid",this,r,e.extend(n,{validationError:r})),!1):!0}});var u=["keys","values","pairs","invert","pick","omit"];e.each(u,function(n){t.AbstractModel.prototype[n]=function(){var t=slice.call(arguments);return t.unshift(this.attributes),e[n].apply(e,t)}})}(n("spirit.model")),function(t){t.StateModel=t.AbstractModel.extend({defaults:{name:"undefined",tweenObj:{}}})}(n("spirit.model")),function(t){t.TimelineElementModel=t.AbstractModel.extend({defaults:{el:null,id:null,transitions:"spirit.collection.TransitionCollection"},initialize:function(t){return this._super(t),this}})}(n("spirit.model")),function(t){t.TransitionModel=t.AbstractModel.extend({defaults:{params:null,ease:"Linear.easeNone"},initialize:function(){}})}(n("spirit.model")),function(t){var e=n("spirit._helpers");t.TransitionParamModel=t.AbstractModel.extend({initialize:function(){console.log("TransitionParamModel -> initialize",e.isPrototypeOf(this))}})}(n("spirit.model")),function(t){var e=n("spirit._helpers"),i={add:!0,remove:!0,merge:!0},o={add:!0,remove:!1};t.AbstractCollection=function(t,i){this.model=r(this.model)?n(this.model):n("spirit.model").AbstractModel,i||(i={}),i.model&&(this.model=i.model),void 0!==i.comparator&&(this.comparator=i.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,e.extend({silent:!0},i))},t.AbstractCollection.extend=e.extendObjectWithSuper,e.extend(t.AbstractCollection.prototype,n("spirit.event").Events,{model:"spirit.model.AbstractModel",initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,n){return this.set(t,e.extend({merge:!1},n,o))},remove:function(t,n){var r=!e.isArray(t);t=r?[t]:e.clone(t),n||(n={});var i,o,u,s;for(i=0,o=t.length;o>i;i++)s=t[i]=this.get(t[i]),s&&(delete this._byId[s.id],delete this._byId[s.cid],u=this.indexOf(s),this.models.splice(u,1),this.length--,n.silent||(n.index=u,s.trigger("remove",s,this,n)),this._removeReference(s));return r?t[0]:t},set:function(t,r){r=e.defaults({},r,i),r.parse&&(t=this.parse(t,r));var o=!e.isArray(t);t=o?t?[t]:[]:e.clone(t);var u,s,a,l,c,f,h,p=r.at,d=this.model,v=this.comparator&&null==p&&r.sort!==!1,g=e.isString(this.comparator)?this.comparator:null,m=[],y=[],_={},b=r.add,w=r.merge,x=r.remove,A=!v&&b&&x?[]:!1;for(u=0,s=t.length;s>u;u++){if(c=t[u],a=c instanceof n("spirit.model").AbstractModel?l=c:c[d.prototype.idAttribute],f=this.get(a))x&&(_[f.cid]=!0),w&&(c=c===l?l.attributes:c,r.parse&&(c=f.parse(c,r)),f.set(c,r),v&&!h&&f.hasChanged(g)&&(h=!0)),t[u]=f;else if(b){if(l=t[u]=this._prepareModel(c,r),!l)continue;m.push(l),l.on("all",this._onModelEvent,this),this._byId[l.cid]=l,null!=l.id&&(this._byId[l.id]=l)}A&&A.push(f||l)}if(x){for(u=0,s=this.length;s>u;++u)_[(l=this.models[u]).cid]||y.push(l);y.length&&this.remove(y,r)}if(m.length||A&&A.length)if(v&&(h=!0),this.length+=m.length,null!=p)for(u=0,s=m.length;s>u;u++)this.models.splice(p+u,0,m[u]);else{A&&(this.models.length=0);var j=A||m;for(u=0,s=j.length;s>u;u++)this.models.push(j[u])}if(h&&this.sort({silent:!0}),!r.silent){for(u=0,s=m.length;s>u;u++)(l=m[u]).trigger("add",l,this,r);(h||A&&A.length)&&this.trigger("sort",this,r)}return o?t[0]:t},reset:function(t,n){n||(n={});for(var r=0,i=this.models.length;i>r;r++)this._removeReference(this.models[r]);return n.previousModels=this.models,this._reset(),t=this.add(t,e.extend({silent:!0},n)),n.silent||this.trigger("reset",this,n),t},push:function(t,n){return this.add(t,e.extend({at:this.length},n))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,n){return this.add(t,e.extend({at:0},n))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return slice.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,n){return e.isEmpty(t)?n?void 0:[]:this[n?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw Error("Cannot sort a set without a comparator");return t||(t={}),e.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(e.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return e.invoke(this.models,"get",t)},create:function(t,n){if(n=n?e.clone(n):{},!(t=this._prepareModel(t,n)))return!1;n.wait||this.add(t,n);var r=this,i=n.success;return n.success=function(t,e,n){n.wait&&r.add(t,n),i&&i(t,e,n)},t.save(null,n),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,r){if(t instanceof n("spirit.model").AbstractModel)return t.collection||(t.collection=this),t;r=r?e.clone(r):{},r.collection=this;var i=new this.model(t,r);return i.validationError?(this.trigger("invalid",this,i.validationError,r),!1):i},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,r),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}}),t.AbstractCollection.parseable=!0;var u=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];e.each(u,function(n){t.AbstractCollection.prototype[n]=function(){var t=[].slice.call(arguments);return t.unshift(this.models),e[n].apply(e,t)}});var s=["groupBy","countBy","sortBy"];e.each(s,function(n){t.AbstractCollection.prototype[n]=function(t,r){var i=e.isFunction(t)?t:function(e){return e.get(t)};return e[n](this.models,i,r)}})}(n("spirit.collection")),function(t){t.StatesCollection=t.AbstractCollection.extend({model:"spirit.model.StateModel"})}(n("spirit.collection")),function(t){t.TransitionCollection=t.AbstractCollection.extend({model:"spirit.model.TransitionModel",initialize:function(){this.on("add",this.added),this.on("remove",this.removed)},added:function(){},removed:function(){}})}(n("spirit.collection")),function(){var t=n("spirit._helpers"),e=(n("spirit.model"),n("spirit.collection")),r=t.isFunction(window.TweenMax)?window.TweenMax:window.TweenLite,i=function(e){if(t.isUndefined(e)||!t.isString(e))return{};var n;try{var r=e.replace(/'|"/g,"").replace(/((?![\d]+|\.)[#\w\.]+|(\+|-)?[\d]+(%|px|em|deg))/g,'"$1"');
n=$.parseJSON(r)}catch(i){}return n};$.fn.spiritAnimateTo=function(){var e=[].slice.call(arguments),n=function(){return t.isString(e[0])},r=function(){return t.isNumber(e[0])};return n()?u.animateToState.apply(this,[e[0],t.isNumber(e[1])?e[1]:o.speed,t.isObject(e[2])?e[2]:{}]):r()?u.animateTo.apply(this,[e[0],t.isObject(e[1])?e[1]:{}]):($.error("invalid function parameters provided for jQuery.spiritAnimateTo. First param needs to be a state (string) or speed (number)"),void 0)};var o={speed:1},u={animateToState:function(n,r,o){return this.each(function(){var s=$(this),a=s.data("spirit-states");if(t.isString(a)){var l=new e.StatesCollection,c=i(a);if(!c)return s.trigger("spirit_error",{msg:"jQuery.spiritAnimateTo: could not parse states: "+a}),void 0;t.each(c,function(t,e){l.add({name:e,tweenObj:t},{silent:!0})}),s.data("spirit-states",l),a=l}if(a instanceof e.StatesCollection){var f=a.where({name:n});if(0===f.length)return s.trigger("spirit_error",{msg:"jQuery.spiritAnimateTo: State["+n+"] not found on element"}),void 0;var h=t.first(f).get("tweenObj");t.isObject(h)&&u.animateTo.apply(this,[r,t.extend(h,o)])}else s.trigger("spirit_error",{msg:"jQuery.spiritAnimateTo: State["+n+"] not found on element"})})},animateTo:function(t,e){var n=function(){var n=$(this);r&&r.to(n,t,e)};return this instanceof HTMLElement?n.call(this):this.each(n)}}}(),"function"==typeof t.define&&t.define.amd?t.define("spiritjs",[],function(){return e}):i.extend(t,e)})(window);