/*!
 * Spirit 0.1.0 (http://spiritjs.io/)
 * Copyright 2013 - 2014 Inlet.
 * Licensed under Apache 2.0 (https://github.com/inlet/spirit.js/blob/master/LICENSE)
 */!function(global){var context={spirit:{VERSION:"0.1.0"}},use=function(a){for(var b=a.split("."),c=0,d=b.length,e=context;d>c;++c){var f=b[c];e[f]||(e[f]={}),e=e[f]}return e},exist=function(a){if("string"!=typeof a)return!1;for(var b=a.split("."),c=!0,d=0,e=b.length,f=context;e>d;++d){var g=b[d];if(!f[g]){c=!1;break}f=f[g]}return c};!function(a){(function(){function b(a,b,c){for(var d=(c||0)-1,e=a?a.length:0;++d<e;)if(a[d]===b)return d;return-1}function c(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||"undefined"==typeof c)return 1;if(d>c||"undefined"==typeof d)return-1}return a.index-b.index}function d(a){return"\\"+rc[a]}function e(){}function f(a){return a instanceof f?a:new g(a)}function g(a,b){this.__chain__=!!b,this.__wrapped__=a}function h(a,b,c){if("function"!=typeof a)return Pb;if("undefined"==typeof b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return Cb(a,b)}function i(a,b,c,d){for(var e=(d||0)-1,f=a?a.length:0,g=[];++e<f;){var h=a[e];if(h&&"object"==typeof h&&"number"==typeof h.length&&(Uc(h)||r(h))){b||(h=i(h,b,c));var j=-1,k=h.length,l=g.length;for(g.length+=k;++j<k;)g[l++]=h[j]}else c||g.push(h)}return g}function j(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;var e=typeof a,g=typeof b;if(!(a!==a||a&&qc[e]||b&&qc[g]))return!1;if(null==a||null==b)return a===b;var h=Fc.call(a),i=Fc.call(b);if(h!=i)return!1;switch(h){case jc:case kc:return+a==+b;case mc:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case oc:case pc:return a==String(b)}var k=h==ic;if(!k){if(Cc.call(a,"__wrapped__ ")||b instanceof f)return j(a.__wrapped__||a,b.__wrapped__||b,c,d);if(h!=nc)return!1;var l=a.constructor,m=b.constructor;if(l!=m&&!(E(l)&&l instanceof l&&E(m)&&m instanceof m))return!1}c||(c=[]),d||(d=[]);for(var n=c.length;n--;)if(c[n]==a)return d[n]==b;var o=!0,p=0;if(c.push(a),d.push(b),k){if(p=b.length,o=p==a.length)for(;p--&&(o=j(a[p],b[p],c,d)););return o}return _c(b,function(b,e,f){return Cc.call(f,e)?(p++,!(o=Cc.call(a,e)&&j(a[e],b,c,d))&&cc):void 0}),o&&_c(a,function(a,b,c){return Cc.call(c,b)?!(o=--p>-1)&&cc:void 0}),o}function k(a,b,c){for(var d=-1,e=p(),f=a?a.length:0,g=[],h=c?[]:g;++d<f;){var i=a[d],j=c?c(i,d,a):i;(b?!d||h[h.length-1]!==j:e(h,j)<0)&&(c&&h.push(j),g.push(i))}return g}function l(a){return function(b,c,d){var e={};c=Fb(c,d,3);var f=-1,g=b?b.length:0;if("number"==typeof g)for(;++f<g;){var h=b[f];a(e,h,c(h,f,b),b)}else ad(b,function(b,d,f){a(e,b,c(b,d,f),f)});return e}}function m(a,b,c,d,e,f){var g=1&b,h=2&b,i=4&b,j=8&b,k=16&b,l=32&b,o=a;if(!h&&!E(a))throw new TypeError;if(k&&!c.length&&(b&=-17,k=c=!1),l&&!d.length&&(b&=-33,l=d=!1),g&&!(h||i||l)&&(Tc.fastBind||Hc&&k)){if(k){var p=[e];Ec.apply(p,c)}var q=k?Hc.apply(a,p):Hc.call(a,e)}else q=function(){var p=arguments,r=g?e:this;if((i||k||l)&&(p=Qc.call(p),k&&Gc.apply(p,c),l&&Ec.apply(p,d),i&&p.length<f))return b|=16,m(a,j?b:-4&b,p,null,e,f);if(h&&(a=r[o]),this instanceof q){r=n(a.prototype);var s=a.apply(r,p);return F(s)?s:r}return a.apply(r,p)};return q}function n(a){return F(a)?Ic(a):{}}function o(a){return Xc[a]}function p(){var a=(a=f.indexOf)===ob?b:a;return a}function q(a){return Yc[a]}function r(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Fc.call(a)==hc||!1}function s(a){if(!a)return a;for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];if(d)for(var e in d)a[e]=d[e]}return a}function t(a){return F(a)?Uc(a)?Qc.call(a):s({},a):a}function u(a){if(!a)return a;for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];if(d)for(var e in d)"undefined"==typeof a[e]&&(a[e]=d[e])}return a}function v(a){var b=[];return _c(a,function(a,c){E(a)&&b.push(c)}),b.sort()}function w(a,b){return a?Cc.call(a,b):!1}function x(a){for(var b=-1,c=Wc(a),d=c.length,e={};++b<d;){var f=c[b];e[a[f]]=f}return e}function y(a){return a===!0||a===!1||Fc.call(a)==jc}function z(a){return a?"object"==typeof a&&Fc.call(a)==kc:!1}function A(a){return a?1===a.nodeType:!1}function B(a){if(!a)return!0;if(Uc(a)||K(a))return!a.length;for(var b in a)if(Cc.call(a,b))return!1;return!0}function C(a,b){return j(a,b)}function D(a){return Kc(a)&&!Lc(parseFloat(a))}function E(a){return"function"==typeof a}function F(a){return!(!a||!qc[typeof a])}function G(a){return I(a)&&a!=+a}function H(a){return null===a}function I(a){return"number"==typeof a||Fc.call(a)==mc}function J(a){return a&&qc[typeof a]?Fc.call(a)==oc:!1}function K(a){return"string"==typeof a||Fc.call(a)==pc}function L(a){return"undefined"==typeof a}function M(a){var b=p(),c=i(arguments,!0,!1,1),d={};return _c(a,function(a,e){b(c,e)<0&&(d[e]=a)}),d}function N(a){for(var b=-1,c=Wc(a),d=c.length,e=Array(d);++b<d;){var f=c[b];e[b]=[f,a[f]]}return e}function O(a){for(var b=-1,c=i(arguments,!0,!1,1),d=c.length,e={};++b<d;){var f=c[b];f in a&&(e[f]=a[f])}return e}function P(a){for(var b=-1,c=Wc(a),d=c.length,e=Array(d);++b<d;)e[b]=a[c[b]];return e}function Q(a,b){var c=p(),d=a?a.length:0,e=!1;return d&&"number"==typeof d?e=c(a,b)>-1:ad(a,function(a){return(e=a===b)&&cc}),e}function R(a,b,c){var d=!0;b=Fb(b,c,3);var e=-1,f=a?a.length:0;if("number"==typeof f)for(;++e<f&&(d=!!b(a[e],e,a)););else ad(a,function(a,c,e){return!(d=!!b(a,c,e))&&cc});return d}function S(a,b,c){var d=[];b=Fb(b,c,3);var e=-1,f=a?a.length:0;if("number"==typeof f)for(;++e<f;){var g=a[e];b(g,e,a)&&d.push(g)}else ad(a,function(a,c,e){b(a,c,e)&&d.push(a)});return d}function T(a,b,c){b=Fb(b,c,3);var d=-1,e=a?a.length:0;if("number"!=typeof e){var f;return ad(a,function(a,c,d){return b(a,c,d)?(f=a,cc):void 0}),f}for(;++d<e;){var g=a[d];if(b(g,d,a))return g}}function U(a,b){return jb(a,b,!0)}function V(a,b,c){var d=-1,e=a?a.length:0;if(b=b&&"undefined"==typeof c?b:h(b,c,3),"number"==typeof e)for(;++d<e&&b(a[d],d,a)!==cc;);else ad(a,b)}function W(a,b){var c=a?a.length:0;if("number"==typeof c)for(;c--&&b(a[c],c,a)!==!1;);else{var d=Wc(a);c=d.length,ad(a,function(a,e,f){return e=d?d[--c]:--c,b(f[e],e,f)===!1&&cc})}}function X(a,b){var c=Qc.call(arguments,2),d=-1,e="function"==typeof b,f=a?a.length:0,g=Array("number"==typeof f?f:0);return V(a,function(a){g[++d]=(e?b:a[b]).apply(a,c)}),g}function Y(a,b,c){var d=-1,e=a?a.length:0;if(b=Fb(b,c,3),"number"==typeof e)for(var f=Array(e);++d<e;)f[d]=b(a[d],d,a);else f=[],ad(a,function(a,c,e){f[++d]=b(a,c,e)});return f}function Z(a,b,c){var d=-1/0,e=d,f=-1,g=a?a.length:0;if(b||"number"!=typeof g)b=Fb(b,c,3),V(a,function(a,c,f){var g=b(a,c,f);g>d&&(d=g,e=a)});else for(;++f<g;){var h=a[f];h>e&&(e=h)}return e}function $(a,b,c){var d=1/0,e=d,f=-1,g=a?a.length:0;if(b||"number"!=typeof g)b=Fb(b,c,3),V(a,function(a,c,f){var g=b(a,c,f);d>g&&(d=g,e=a)});else for(;++f<g;){var h=a[f];e>h&&(e=h)}return e}function _(a,b){var c=-1,d=a?a.length:0;if("number"==typeof d)for(var e=Array(d);++c<d;)e[c]=a[c][b];return e||Y(a,b)}function ab(a,b,c,d){if(!a)return c;var e=arguments.length<3;b=h(b,d,4);var f=-1,g=a.length;if("number"==typeof g)for(e&&(c=a[++f]);++f<g;)c=b(c,a[f],f,a);else ad(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)});return c}function bb(a,b,c,d){var e=arguments.length<3;return b=h(b,d,4),W(a,function(a,d,f){c=e?(e=!1,a):b(c,a,d,f)}),c}function cb(a,b,c){return b=Fb(b,c,3),S(a,function(a,c,d){return!b(a,c,d)})}function db(a,b,c){var d=a?a.length:0;if("number"!=typeof d&&(a=P(a)),null==b||c)return a?a[Sb(d-1)]:ac;var e=eb(a);return e.length=Oc(Nc(0,b),e.length),e}function eb(a){var b=-1,c=a?a.length:0,d=Array("number"==typeof c?c:0);return V(a,function(a){var c=Sb(++b);d[b]=d[c],d[c]=a}),d}function fb(a){var b=a?a.length:0;return"number"==typeof b?b:Wc(a).length}function gb(a,b,c){var d;b=Fb(b,c,3);var e=-1,f=a?a.length:0;if("number"==typeof f)for(;++e<f&&!(d=b(a[e],e,a)););else ad(a,function(a,c,e){return(d=b(a,c,e))&&cc});return!!d}function hb(a,b,d){var e=-1,f=a?a.length:0,g=Array("number"==typeof f?f:0);for(b=Fb(b,d,3),V(a,function(a,c,d){g[++e]={criteria:b(a,c,d),index:e,value:a}}),f=g.length,g.sort(c);f--;)g[f]=g[f].value;return g}function ib(a){return Uc(a)?Qc.call(a):a&&"number"==typeof a.length?Y(a):P(a)}function jb(a,b,c){return c&&B(b)?ac:(c?T:S)(a,b)}function kb(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function lb(a){for(var b=-1,c=p(),d=a.length,e=i(arguments,!0,!0,1),f=[];++b<d;){var g=a[b];c(e,g)<0&&f.push(g)}return f}function mb(a,b,c){var d=0,e=a?a.length:0;if("number"!=typeof b&&null!=b){var f=-1;for(b=Fb(b,c,3);++f<e&&b(a[f],f,a);)d++}else if(d=b,null==d||c)return a?a[0]:ac;return Qc.call(a,0,Oc(Nc(0,d),e))}function nb(a,b){return i(a,b)}function ob(a,c,d){if("number"==typeof d){var e=a?a.length:0;d=0>d?Nc(0,e+d):d||0}else if(d){var f=vb(a,c);return a[f]===c?f:-1}return b(a,c,d)}function pb(a,b,c){var d=0,e=a?a.length:0;if("number"!=typeof b&&null!=b){var f=e;for(b=Fb(b,c,3);f--&&b(a[f],f,a);)d++}else d=null==b||c?1:b||d;return Qc.call(a,0,Oc(Nc(0,e-d),e))}function qb(a){var b=arguments,c=b.length,d=-1,e=p(),f=a?a.length:0,g=[];a:for(;++d<f;){var h=a[d];if(e(g,h)<0){for(var i=c;--i;)if(e(b[i],h)<0)continue a;g.push(h)}}return g}function rb(a,b,c){var d=0,e=a?a.length:0;if("number"!=typeof b&&null!=b){var f=e;for(b=Fb(b,c,3);f--&&b(a[f],f,a);)d++}else if(d=b,null==d||c)return a?a[e-1]:ac;return Qc.call(a,Nc(0,e-d))}function sb(a,b,c){var d=a?a.length:0;for("number"==typeof c&&(d=(0>c?Nc(0,d+c):Oc(c,d-1))+1);d--;)if(a[d]===b)return d;return-1}function tb(a,b,c){a=+a||0,c=+c||1,null==b&&(b=a,a=0);for(var d=-1,e=Nc(0,Ac((b-a)/c)),f=Array(e);++d<e;)f[d]=a,a+=c;return f}function ub(a,b,c){if("number"!=typeof b&&null!=b){var d=0,e=-1,f=a?a.length:0;for(b=Fb(b,c,3);++e<f&&b(a[e],e,a);)d++}else d=null==b||c?1:Nc(0,b);return Qc.call(a,d)}function vb(a,b,c,d){var e=0,f=a?a.length:e;for(c=c?Fb(c,d,1):Pb,b=c(b);f>e;){var g=e+f>>>1;c(a[g])<b?e=g+1:f=g}return e}function wb(){return k(i(arguments,!0,!0))}function xb(a,b,c,d){return"boolean"!=typeof b&&null!=b&&(d=c,c=d&&d[b]===a?null:b,b=!1),null!=c&&(c=Fb(c,d,3)),k(a,b,c)}function yb(a){return lb(a,Qc.call(arguments,1))}function zb(){for(var a=-1,b=Z(_(arguments,"length")),c=Array(0>b?0:b);++a<b;)c[a]=_(arguments,a);return c}function Ab(a,b){for(var c=-1,d=a?a.length:0,e={};++c<d;){var f=a[c];b?e[f]=b[c]:f&&(e[f[0]]=f[1])}return e}function Bb(a,b){if(!E(b))throw new TypeError;return function(){return--a<1?b.apply(this,arguments):void 0}}function Cb(a,b){return arguments.length>2?m(a,17,Qc.call(arguments,2),null,b):m(a,1,null,null,b)}function Db(a){for(var b=arguments.length>1?i(arguments,!0,!1,1):v(a),c=-1,d=b.length;++c<d;){var e=b[c];a[e]=m(a[e],1,null,null,a)}return a}function Eb(){for(var a=arguments,b=a.length;b--;)if(!E(a[b]))throw new TypeError;return function(){for(var b=arguments,c=a.length;c--;)b=[a[c].apply(this,b)];return b[0]}}function Fb(a,b,c){var d=typeof a;if(null==a||"function"==d)return h(a,b,c);if("object"!=d)return function(b){return b[a]};var e=Wc(a);return function(b){for(var c=e.length,d=!1;c--&&(d=b[e[c]]===a[e[c]]););return d}}function Gb(a,b,c){var d,e,f,g,h,i,j,k=0,l=!1,m=!0;if(!E(a))throw new TypeError;if(b=Nc(0,b)||0,c===!0){var n=!0;m=!1}else F(c)&&(n=c.leading,l="maxWait"in c&&(Nc(b,c.maxWait)||0),m="trailing"in c?c.trailing:m);var o=function(){var c=b-(Dc()-g);if(0>=c){e&&clearTimeout(e);var l=j;e=i=j=ac,l&&(k=Dc(),f=a.apply(h,d))}else i=setTimeout(o,c)},p=function(){i&&clearTimeout(i),e=i=j=ac,(m||l!==b)&&(k=Dc(),f=a.apply(h,d))};return function(){if(d=arguments,g=Dc(),h=this,j=m&&(i||!n),l===!1)var c=n&&!i;else{e||n||(k=g);var q=l-(g-k);0>=q?(e&&(e=clearTimeout(e)),k=g,f=a.apply(h,d)):e||(e=setTimeout(p,q))}return i||b===l||(i=setTimeout(o,b)),c&&(f=a.apply(h,d)),f}}function Hb(a){if(!E(a))throw new TypeError;var b=Qc.call(arguments,1);return setTimeout(function(){a.apply(ac,b)},1)}function Ib(a,b){if(!E(a))throw new TypeError;var c=Qc.call(arguments,2);return setTimeout(function(){a.apply(ac,c)},b)}function Jb(a,b){var c={};return function(){var d=b?b.apply(this,arguments):dc+arguments[0];return Cc.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}}function Kb(a){var b,c;if(!E(a))throw new TypeError;return function(){return b?c:(b=!0,c=a.apply(this,arguments),a=null,c)}}function Lb(a){return m(a,16,Qc.call(arguments,1))}function Mb(a,b,c){var d=!0,e=!0;if(!E(a))throw new TypeError;return c===!1?d=!1:F(c)&&(d="leading"in c?c.leading:d,e="trailing"in c?c.trailing:e),c={},c.leading=d,c.maxWait=b,c.trailing=e,Gb(a,b,c)}function Nb(a,b){if(!E(b))throw new TypeError;return function(){var c=[a];return Ec.apply(c,arguments),b.apply(this,c)}}function Ob(a){return null==a?"":String(a).replace($c,o)}function Pb(a){return a}function Qb(a){V(v(a),function(b){var c=f[b]=a[b];f.prototype[b]=function(){var a=[this.__wrapped__];Ec.apply(a,arguments);var b=c.apply(f,a);return this.__chain__?new g(b,!0):b}})}function Rb(){return sc._=yc,this}function Sb(a,b){return null==a&&null==b&&(b=1),a=+a||0,null==b?(b=a,a=0):b=+b||0,a+Bc(Pc()*(b-a+1))}function Tb(a,b){if(a){var c=a[b];return E(c)?a[b]():c}}function Ub(a,b,c){var e=f,g=e.templateSettings;a||(a=""),c=u({},c,g);var h=0,i="__p += '",j=c.variable,k=RegExp((c.escape||fc).source+"|"+(c.interpolate||fc).source+"|"+(c.evaluate||fc).source+"|$","g");a.replace(k,function(b,c,e,f,g){return i+=a.slice(h,g).replace(gc,d),c&&(i+="' +\n_.escape("+c+") +\n'"),f&&(i+="';\n"+f+";\n__p += '"),e&&(i+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),h=g+b.length,b}),i+="';\n",j||(j="obj",i="with ("+j+" || {}) {\n"+i+"\n}\n"),i="function("+j+") {\nvar __t, __p = '', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n"+i+"return __p\n}";try{var l=Function("_","return "+i)(e)}catch(m){throw m.source=i,m}return b?l(b):(l.source=i,l)}function Vb(a,b,c){a=(a=+a)>-1?a:0;var d=-1,e=Array(a);for(b=h(b,c,1);++d<a;)e[d]=b(d);return e}function Wb(a){return null==a?"":String(a).replace(Zc,q)}function Xb(a){var b=++bc+"";return a?a+b:b}function Yb(a){return a=new g(a),a.__chain__=!0,a}function Zb(a,b){return b(a),a}function $b(){return this.__chain__=!0,this}function _b(){return this.__wrapped__}var ac,bc=0,cc={},dc=+new Date+"",ec=/<%=([\s\S]+?)%>/g,fc=/($^)/,gc=/['\n\r\t\u2028\u2029\\]/g,hc="[object Arguments]",ic="[object Array]",jc="[object Boolean]",kc="[object Date]",lc="[object Function]",mc="[object Number]",nc="[object Object]",oc="[object RegExp]",pc="[object String]",qc={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},rc={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},sc=qc[typeof window]&&window||this,tc=qc[typeof exports]&&exports&&!exports.nodeType&&exports,uc=qc[typeof module]&&module&&!module.nodeType&&module,vc=(uc&&uc.exports===tc&&tc,qc[typeof global]&&global);!vc||vc.global!==vc&&vc.window!==vc||(sc=vc);var wc=[],xc=Object.prototype,yc=sc._,zc=RegExp("^"+String(xc.valueOf).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/valueOf|for [^\]]+/g,".+?")+"$"),Ac=Math.ceil,Bc=Math.floor,Cc=xc.hasOwnProperty,Dc=zc.test(Dc=Date.now)&&Dc||function(){return+new Date},Ec=wc.push,Fc=xc.toString,Gc=wc.unshift,Hc=zc.test(Hc=Fc.bind)&&Hc,Ic=zc.test(Ic=Object.create)&&Ic,Jc=zc.test(Jc=Array.isArray)&&Jc,Kc=sc.isFinite,Lc=sc.isNaN,Mc=zc.test(Mc=Object.keys)&&Mc,Nc=Math.max,Oc=Math.min,Pc=Math.random,Qc=wc.slice,Rc=zc.test(sc.attachEvent),Sc=Hc&&!/\n|true/.test(Hc+Rc);g.prototype=f.prototype;var Tc={};!function(){var a={0:1,length:1};Tc.fastBind=Hc&&!Sc,Tc.spliceObjects=(wc.splice.call(a,0,1),!a[0])}(1),f.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:ec,variable:""},Ic||(n=function(a){if(F(a)){e.prototype=a;var b=new e;e.prototype=null}return b||{}}),r(arguments)||(r=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Cc.call(a,"callee")||!1});var Uc=Jc||function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Fc.call(a)==ic||!1},Vc=function(a){var b,c=a,d=[];if(!c)return d;if(!qc[typeof a])return d;for(b in c)Cc.call(c,b)&&d.push(b);return d},Wc=Mc?function(a){return F(a)?Mc(a):[]}:Vc,Xc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Yc=x(Xc),Zc=RegExp("("+Wc(Yc).join("|")+")","g"),$c=RegExp("["+Wc(Xc).join("")+"]","g"),_c=function(a,b){var c,d=a,e=d;if(!d)return e;if(!qc[typeof d])return e;for(c in d)if(b(d[c],c,a)===cc)return e;return e},ad=function(a,b){var c,d=a,e=d;if(!d)return e;if(!qc[typeof d])return e;for(c in d)if(Cc.call(d,c)&&b(d[c],c,a)===cc)return e;return e};E(/x/)&&(E=function(a){return"function"==typeof a&&Fc.call(a)==lc});var bd=l(function(a,b,c){Cc.call(a,c)?a[c]++:a[c]=1}),cd=l(function(a,b,c){(Cc.call(a,c)?a[c]:a[c]=[]).push(b)}),dd=l(function(a,b,c){a[c]=b});f.after=Bb,f.bind=Cb,f.bindAll=Db,f.chain=Yb,f.compact=kb,f.compose=Eb,f.countBy=bd,f.debounce=Gb,f.defaults=u,f.defer=Hb,f.delay=Ib,f.difference=lb,f.filter=S,f.flatten=nb,f.forEach=V,f.functions=v,f.groupBy=cd,f.indexBy=dd,f.initial=pb,f.intersection=qb,f.invert=x,f.invoke=X,f.keys=Wc,f.map=Y,f.max=Z,f.memoize=Jb,f.min=$,f.omit=M,f.once=Kb,f.pairs=N,f.partial=Lb,f.pick=O,f.pluck=_,f.range=tb,f.reject=cb,f.rest=ub,f.shuffle=eb,f.sortBy=hb,f.tap=Zb,f.throttle=Mb,f.times=Vb,f.toArray=ib,f.union=wb,f.uniq=xb,f.values=P,f.where=jb,f.without=yb,f.wrap=Nb,f.zip=zb,f.collect=Y,f.drop=ub,f.each=V,f.extend=s,f.methods=v,f.object=Ab,f.select=S,f.tail=ub,f.unique=xb,f.clone=t,f.contains=Q,f.escape=Ob,f.every=R,f.find=T,f.has=w,f.identity=Pb,f.indexOf=ob,f.isArguments=r,f.isArray=Uc,f.isBoolean=y,f.isDate=z,f.isElement=A,f.isEmpty=B,f.isEqual=C,f.isFinite=D,f.isFunction=E,f.isNaN=G,f.isNull=H,f.isNumber=I,f.isObject=F,f.isRegExp=J,f.isString=K,f.isUndefined=L,f.lastIndexOf=sb,f.mixin=Qb,f.noConflict=Rb,f.random=Sb,f.reduce=ab,f.reduceRight=bb,f.result=Tb,f.size=fb,f.some=gb,f.sortedIndex=vb,f.template=Ub,f.unescape=Wb,f.uniqueId=Xb,f.all=R,f.any=gb,f.detect=T,f.findWhere=U,f.foldl=ab,f.foldr=bb,f.include=Q,f.inject=ab,f.first=mb,f.last=rb,f.sample=db,f.take=mb,f.head=mb,Qb(f),f.VERSION="2.2.1",f.prototype.chain=$b,f.prototype.value=_b,V(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=wc[a];f.prototype[a]=function(){var a=this.__wrapped__;return b.apply(a,arguments),Tc.spliceObjects||0!==a.length||delete a[0],this}}),V(["concat","join","slice"],function(a){var b=wc[a];f.prototype[a]=function(){var a=this.__wrapped__,c=b.apply(a,arguments);return this.__chain__&&(c=new g(c),c.__chain__=!0),c}}),f.extend(a,f)}).call(a)}(use("spirit._helpers")),function(a){"use strict";var b=function(){};a.extendObject=function(b,c){var d,e=this;d=b&&a.has(b,"constructor")?b.constructor:function(){return e.apply(this,arguments)},a.extend(d,e,c);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,b&&a.extend(d.prototype,b),d.__super__=e.prototype,d};var c=function(c,d,e){var f,g=c.prototype,h=/xyz/.test(function(a){})?/\b_super\b/:/.*/;if(f=d&&d.hasOwnProperty("constructor")?d.constructor:function(){c.apply(this,arguments)},a.extend(f,c),b.prototype=c.prototype,f.prototype=new b,d){a.extend(f.prototype,d);for(var i in d)"function"==typeof d[i]&&"function"==typeof g[i]&&h.test(d[i])&&(f.prototype[i]=function(a,b){return function(){var c=this._super;this._super=g[a];var d=b.apply(this,arguments);return this._super=c,d}}(i,d[i]))}return e&&a.extend(f,e),f.prototype.constructor=f,f.__super__=c.prototype,f};a.extendObjectWithSuper=function(b,d){var e=c(this,b,d);return e.extend=a.extendObject,e},a.autoBind=function(b){var c=a.functions(b.constructor.prototype);a.each(c,function(c){"_"!==c.charAt(0)&&-1===a.indexOf(["autoBind","constructor"],c)&&(b[c]=a.bind(b[c],b))})},a.testMode=function(){return!!window.__karma__}}(use("spirit._helpers"));var debug=!0,_=use("spirit._helpers"),log=function(){if(window.__karma__)return!1;if(window.console&&_.isFunction(window.console.log)){var a=[].slice.call(arguments);a.unshift("Spirit: ->"),console.log.apply(console,a)}return!0},globalDefaults={tween:_.isFunction(window.TweenMax)?window.TweenMax:window.TweenLite,timeline:_.isFunction(window.TimelineMax)?window.TimelineMax:window.TimelineLite};!function(a){"use strict";var b=/\s+/,c=function(a,c,d,e){if(!d)return!0;if("object"==typeof d){for(var f in d)a[c].apply(a,[f,d[f]].concat(e));return!1}if(b.test(d)){for(var g=d.split(b),h=0,i=g.length;i>h;h++)a[c].apply(a,[g[h]].concat(e));return!1}return!0},d=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}};a.Events={on:function(a,b,d){if(!c(this,"on",a,[b,d])||!b)return this;this._events||(this._events={});var e=this._events[a]||(this._events[a]=[]);return e.push({callback:b,context:d,ctx:d||this}),this},once:function(a,b,d){if(!c(this,"once",a,[b,d])||!b)return this;var e=this,f=_.once(function(){e.off(a,f),b.apply(this,arguments)});return f._callback=b,this.on(a,f,d)},off:function(a,b,d){var e,f,g,h,i,j,k,l;if(!this._events||!c(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events={},this;for(h=a?[a]:_.keys(this._events),i=0,j=h.length;j>i;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=e=[],b||d)for(k=0,l=g.length;l>k;k++)f=g[k],(b&&b!==f.callback&&b!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=[].slice.call(arguments,1);if(!c(this,"trigger",a,b))return this;var e=this._events[a],f=this._events.all;return e&&d(e,b),f&&d(f,arguments),this},stopListening:function(a,b,c){var d=this._listeningTo;if(!d)return this;var e=!b&&!c;c||"object"!=typeof b||(c=this),a&&((d={})[a._listenId]=a);for(var f in d)a=d[f],a.off(b,c,this),(e||_.isEmpty(a._events))&&delete this._listeningTo[f];return this}}}(use("spirit.event")),function(a){"use strict";var b=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}},c=function(a){var b=a;try{if(_.isString(b)&&exist(b)&&(b=use(b)),b.parseable===!0)return b;if(b.constructor.parseable===!0)return b.constructor}catch(c){}return!1};a.AbstractModel=function(a,b){this._parseables={},_.each(this.defaults,function(a,b){var d=c(a);d&&(this._parseables[b]=d)},this);var d=a||{};b||(b={}),this.cid=_.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(d=this.parse(d,b)||{}),d=_.defaults({},d,_.result(this,"defaults")),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)},a.AbstractModel.extend=_.extendObjectWithSuper,_.extend(a.AbstractModel.prototype,use("spirit.event").Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return _.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){return _.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(b,c,d){var e,f,g,h,i,j,k,l;if(null==b)return this;if("object"==typeof b?(f=b,d=c):(f={})[b]=c,d||(d={}),!this._validate(f,d))return!1;g=d.unset,i=d.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=_.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(e in f)if(c=f[e],_.isEqual(l[e],c)||h.push(e),_.isEqual(k[e],c)?delete this.changed[e]:this.changed[e]=c,g)delete l[e];else{var m=this._parseables[e];l[e]=m?_.isArray(c)||_.isObject(c)&&c instanceof a.AbstractModel?new m(c):new m:c}if(!i){h.length&&(this._pending=!0);for(var n=0,o=h.length;o>n;n++)this.trigger("change:"+h[n],this,l[h[n]],d)}if(j)return this;if(!i)for(;this._pending;)this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,_.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var c in this.attributes)b[c]=void 0;return this.set(b,_.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!_.isEmpty(this.changed):_.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?_.clone(this.changed):!1;var b,c=!1,d=this._changing?this._previousAttributes:this.attributes;for(var e in a)_.isEqual(d[e],b=a[e])||((c||(c={}))[e]=b);return c},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(a){a=a?_.clone(a):{},void 0===a.parse&&(a.parse=!0);var c=this,d=a.success;return a.success=function(b){return c.set(c.parse(b,a),a)?(d&&d(c,b,a),void c.trigger("sync",c,b,a)):!1},b(this,a),this.sync("read",this,a)},destroy:function(a){a=a?_.clone(a):{};var c=this,d=a.success,e=function(){c.trigger("destroy",c,c.collection,a)};return a.success=function(b){(a.wait||c.isNew())&&e(),d&&d(c,b,a),c.isNew()||c.trigger("sync",c,b,a)},this.isNew()?(a.success(),!1):(b(this,a),a.wait||e(),!0)},url:function(){var a=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(a){return this._validate({},_.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=_.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;return c?(this.trigger("invalid",this,c,_.extend(b,{validationError:c})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];_.each(d,function(b){a.AbstractModel.prototype[b]=function(){var a=slice.call(arguments);return a.unshift(this.attributes),_[b].apply(_,a)}})}(use("spirit.model")),function(a){"use strict";a.StateModel=a.AbstractModel.extend({defaults:{name:"undefined",tweenObj:{}}})}(use("spirit.model")),function(a){"use strict";a.TimelineModel=a.AbstractModel.extend({defaults:{el:null,id:null,transitions:"spirit.collection.TransitionCollection"}})}(use("spirit.model")),function(a){"use strict";a.TransitionModel=a.AbstractModel.extend({defaults:{params:null,ease:"Linear.easeNone"}})}(use("spirit.model")),function(ns){"use strict";ns.TransitionParamModel=ns.AbstractModel.extend({defaults:{param:null,value:null},isCSSTransform:function(){var a=ns.TransitionParamModel.params,b=[a.translateX,a.translateY,a.translateZ,a.rotateX,a.rotateY,a.rotateZ,a.skewX,a.skewY,a.scaleX,a.scaleY];return _.contains(b,this.get("param"))},isEval:function(){return/\{(.*?)\}/.test(this.get("value"))},getValue:function(mappings){var v=this.get("value");if(this.isEval()){if(mappings){var extractionObject={};_.each(_.isArray(mappings)?mappings:[mappings],function(a){a.expression instanceof RegExp&&(a.expression.global&&(a.expression.lastIndex=0),a.expression.test(v)&&(extractionObject[a.expression]=a))});for(var i in extractionObject)v=v.replace(extractionObject[i].expression,"extractionObject["+i+"].map")}try{return eval(v)}catch(e){}}return v}}),ns.TransitionParamModel.params={autoAlpha:"autoAlpha",translateX:"translateX",translateY:"translateY",translateZ:"translateZ",rotateX:"rotateX",rotateY:"rotateY",rotateZ:"rotateZ",skewX:"skewX",skewY:"skewY",scaleX:"scaleX",scaleY:"scaleY",opacity:"opacity",transformOrigin:"transformOrigin",perspective:"perspective",backgroundPositionX:"backgroundPositionX",backgroundPositionY:"backgroundPositionY",width:"width",height:"height",color:"color",backgroundColor:"backgroundColor",paddingTop:"paddingTop",paddingBottom:"paddingBottom",paddingLeft:"paddingLeft",paddingRight:"paddingRight",marginTop:"marginTop",marginBottom:"marginBottom",marginLeft:"marginLeft",marginRight:"marginRight",fontSize:"fontSize",borderWidth:"borderWidth",borderColor:"borderColor",borderTopWidth:"borderTopWidth",borderBottomWidth:"borderBottomWidth",borderLeftWidth:"borderLeftWidth",borderRightWidth:"borderRightWidth",borderTopColor:"borderTopColor",borderBottomColor:"borderBottomColor",borderLeftColor:"borderLeftColor",borderRightColor:"borderRightColor",borderTopLeftRadius:"borderTopLeftRadius",borderTopRightRadius:"borderTopRightRadius",borderBottomRightRadius:"borderBottomRightRadius",borderBottomLeftRadius:"borderBottomLeftRadius"}}(use("spirit.model")),function(a){"use strict";a.RegExpMapping=function(a,b){this.expression=a,this.map=b}}(use("spirit.model.vo")),function(a){"use strict";var b={add:!0,remove:!0,merge:!0},c={add:!0,remove:!1};a.AbstractCollection=function(a,b){this.model=exist(this.model)?use(this.model):use("spirit.model").AbstractModel,b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,_.extend({silent:!0},b))},a.AbstractCollection.extend=_.extendObjectWithSuper,_.extend(a.AbstractCollection.prototype,use("spirit.event").Events,{model:"spirit.model.AbstractModel",initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(a,b){return this.set(a,_.extend({merge:!1},b,c))},remove:function(a,b){var c=!_.isArray(a);a=c?[a]:_.clone(a),b||(b={});var d,e,f,g;for(d=0,e=a.length;e>d;d++)g=a[d]=this.get(a[d]),g&&(delete this._byId[g.id],delete this._byId[g.cid],f=this.indexOf(g),this.models.splice(f,1),this.length--,b.silent||(b.index=f,g.trigger("remove",g,this,b)),this._removeReference(g));return c?a[0]:a},set:function(a,c){c=_.defaults({},c,b),c.parse&&(a=this.parse(a,c));var d=!_.isArray(a);a=d?a?[a]:[]:_.clone(a);var e,f,g,h,i,j,k,l=c.at,m=this.model,n=this.comparator&&null==l&&c.sort!==!1,o=_.isString(this.comparator)?this.comparator:null,p=[],q=[],r={},s=c.add,t=c.merge,u=c.remove,v=!n&&s&&u?[]:!1;for(e=0,f=a.length;f>e;e++){if(i=a[e],g=i instanceof use("spirit.model").AbstractModel?h=i:i[m.prototype.idAttribute],j=this.get(g))u&&(r[j.cid]=!0),t&&(i=i===h?h.attributes:i,c.parse&&(i=j.parse(i,c)),j.set(i,c),n&&!k&&j.hasChanged(o)&&(k=!0)),a[e]=j;else if(s){if(h=a[e]=this._prepareModel(i,c),!h)continue;p.push(h),h.on("all",this._onModelEvent,this),this._byId[h.cid]=h,null!=h.id&&(this._byId[h.id]=h)}v&&v.push(j||h)}if(u){for(e=0,f=this.length;f>e;++e)r[(h=this.models[e]).cid]||q.push(h);q.length&&this.remove(q,c)}if(p.length||v&&v.length)if(n&&(k=!0),this.length+=p.length,null!=l)for(e=0,f=p.length;f>e;e++)this.models.splice(l+e,0,p[e]);else{v&&(this.models.length=0);var w=v||p;for(e=0,f=w.length;f>e;e++)this.models.push(w[e])}if(k&&this.sort({silent:!0}),!c.silent){for(e=0,f=p.length;f>e;e++)(h=p[e]).trigger("add",h,this,c);(k||v&&v.length)&&this.trigger("sort",this,c)}return d?a[0]:a},reset:function(a,b){b||(b={});for(var c=0,d=this.models.length;d>c;c++)this._removeReference(this.models[c]);return b.previousModels=this.models,this._reset(),a=this.add(a,_.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,_.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,_.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return slice.apply(this.models,arguments)},get:function(a){return null==a?void 0:this._byId[a.id]||this._byId[a.cid]||this._byId[a]},at:function(a){return this.models[a]},where:function(a,b){return _.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),_.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(_.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return _.invoke(this.models,"get",a)},create:function(a,b){if(b=b?_.clone(b):{},!(a=this._prepareModel(a,b)))return!1;
b.wait||this.add(a,b);var c=this,d=b.success;return b.success=function(a,b,e){e.wait&&c.add(a,e),d&&d(a,b,e)},a.save(null,b),a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof use("spirit.model").AbstractModel)return a.collection||(a.collection=this),a;b=b?_.clone(b):{},b.collection=this;var c=new this.model(a,b);return c.validationError?(this.trigger("invalid",this,c.validationError,b),!1):c},_removeReference:function(a){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}}),a.AbstractCollection.parseable=!0;var d=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];_.each(d,function(b){a.AbstractCollection.prototype[b]=function(){var a=[].slice.call(arguments);return a.unshift(this.models),_[b].apply(_,a)}});var e=["groupBy","countBy","sortBy"];_.each(e,function(b){a.AbstractCollection.prototype[b]=function(a,c){var d=_.isFunction(a)?a:function(b){return b.get(a)};return _[b](this.models,d,c)}})}(use("spirit.collection")),function(a){"use strict";a.StatesCollection=a.AbstractCollection.extend({model:"spirit.model.StateModel"})}(use("spirit.collection")),function(a){"use strict";a.TransitionCollection=a.AbstractCollection.extend({model:"spirit.model.TransitionModel",initialize:function(){this.on("add",this.added),this.on("remove",this.removed)},added:function(){},removed:function(){}})}(use("spirit.collection")),function(a){"use strict";a.TransitionParamCollection=a.AbstractCollection.extend({model:"spirit.model.TransitionParamModel",constructTweenObject:function(a){var b={},c=use("spirit.model").TransitionParamModel.params;return _.each(this.filter(function(a){return null!==a.get("param")&&null!==a.get("value")}),function(d){if(d.isCSSTransform())switch(d.get("param")){case c.translateX:b.x=d.getValue(a);break;case c.translateY:b.y=d.getValue(a);break;case c.translateZ:b.z=d.getValue(a);break;case c.rotateX:b.rotationX="+="+d.getValue(a)+"deg";break;case c.rotateY:b.rotationY="+="+d.getValue(a)+"deg";break;case c.rotateZ:b.rotationZ="+="+d.getValue(a)+"deg";break;case c.skewX:b.skewX=d.getValue(a)+"deg";break;case c.skewY:b.skewY=d.getValue(a)+"deg";break;case c.scaleX:b.scaleX=d.getValue(a);break;case c.scaleY:b.scaleY=d.getValue(a)}else b[d.get("param")]=d.getValue(a)}),b}})}(use("spirit.collection")),function(){"use strict";var a=(use("spirit.model"),use("spirit.collection")),b=globalDefaults.tween,c=function(a){var b={};try{var c=a.replace(/'|"/g,"").replace(/((?![\d]+|\.)[#\w\.]+|(\+|-)?[\d]+(%|px|em|deg))/g,'"$1"');b=$.parseJSON(c)}catch(d){}return b};$.fn.spiritAnimateTo=function(){var a=[].slice.call(arguments),b=function(){return _.isString(a[0])},c=function(){return _.isNumber(a[0])};return b()?e.animateToState.apply(this,[a[0],_.isNumber(a[1])?a[1]:d.speed,_.isObject(a[2])?a[2]:{}]):c()?e.animateTo.apply(this,[a[0],_.isObject(a[1])?a[1]:{}]):void $.error("invalid function parameters provided for jQuery.spiritAnimateTo. First param needs to be a state (string) or speed (number)")};var d={speed:1},e={animateToState:function(b,d,f){return this.each(function(){var g=$(this),h=g.data("spirit-states");if(_.isString(h)){var i=new a.StatesCollection,j=c(h);if(0===_.size(j))return void g.trigger("spirit_error",{msg:"jQuery.spiritAnimateTo: could not parse states: "+h});_.each(j,function(a,b){i.add({name:b,tweenObj:a},{silent:!0})}),g.data("spirit-states",i),h=i}if(h instanceof a.StatesCollection){var k=h.where({name:b});if(0===k.length)return void g.trigger("spirit_error",{msg:"jQuery.spiritAnimateTo: State["+b+"] not found on element"});var l=_.first(k).get("tweenObj");_.isObject(l)&&e.animateTo.apply(this,[d,_.extend(l,f)])}else g.trigger("spirit_error",{msg:"jQuery.spiritAnimateTo: State["+b+"] not found on element"})})},animateTo:function(a,c){var d=function(){var d=$(this);b&&b.to(d,a,c)};return this instanceof HTMLElement?d.call(this):this.each(d)}}}(),"function"==typeof define&&define.amd?define(function(){return context.spirit||{}}):_.extend(global,context)}(window);
//# sourceMappingURL=spirit.min.js.map